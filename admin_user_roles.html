{% extends "base.html" %}
{% block content %}

<div class="row between" style="margin-top:10px;">
  <div>
    <div class="kicker">Admin</div>
    <h1 style="margin:6px 0 0;">Roles for {{ u["username"] }}</h1>
    <div class="muted small">Assign or remove roles for this user.</div>
  </div>
  <a class="btn ghost" href="{{ url_for('user_profile', username=u['username']) }}">View profile</a>
</div>

<div class="panel" style="margin-top:14px; max-width:720px;">
  <div class="kicker">Assign role</div>

  {% if roles and roles|length > 0 %}
    <form method="post" action="{{ url_for('admin_user_roles_assign', username=u['username']) }}" style="margin-top:10px;">
      <div class="field">
        <label>Role</label>
        <select name="role_id" required>
          {% for r in roles %}
            <option value="{{ r['id'] }}">{{ r["name"] }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="actions">
        <button class="btn green" type="submit">Assign</button>
      </div>
    </form>
  {% else %}
    <div class="muted" style="margin-top:10px;">No roles exist yet. Create one first.</div>
  {% endif %}
</div>

<div class="panel" style="margin-top:14px;">
  <div class="kicker">Current roles</div>

  {% if user_roles and user_roles|length > 0 %}
    <div class="stack" style="margin-top:12px;">
      {% for r in user_roles %}
        <div class="row between" style="padding:10px; border:1px solid rgba(255,255,255,.07); border-radius:12px;">
          <span class="role_tag"
                {% if r["color"] %}style="border-color: {{ r['color'] }}; color: {{ r['color'] }};"{% endif %}>
            {{ r["name"] }}
          </span>

          <form method="post" action="{{ url_for('admin_user_roles_remove', username=u['username']) }}">
            <input type="hidden" name="role_id" value="{{ r['id'] }}">
            <button class="btn ghost" type="submit">Remove</button>
          </form>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="muted" style="margin-top:10px;">No roles assigned.</div>
  {% endif %}
</div>

{% endblock %}